# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license

# Faster-FD-YOLO (FasterNet + Frequency-aware Dynamic Gate)
# --------------------------------------------------------
# æ ¸å¿ƒç­–ç•¥: "æè‡´è½»é‡åŒ–ä¸»å¹² + é«˜ç²¾åº¦åŒæµå¤´"
# 1. Backbone: å¼•å…¥ CVPR'23 FasterNet (C3_Faster)ï¼Œåˆ©ç”¨ PConv ç‰©ç†çº§é™å‚ã€‚
# 2. Head: ä¿æŒ FD-Gate (Row 11)ï¼Œç¡®ä¿ Tricycle æ£€æµ‹ç²¾åº¦ã€‚
# --------------------------------------------------------

# Parameters
nc: 6 # SODA10M
scales: 
  n: [0.50, 0.25, 1024] 

# Backbone (ä½¿ç”¨ FasterNet PConv é‡æ„)
backbone:
  # [from, repeats, module, args]
  - [-1, 1, Conv, [64, 3, 2]] # 0-P1/2
  - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4 <--- ç»†èŠ‚æµæºå¤´
  
  # ğŸš€ [æ›¿æ¢] C3k2 -> C3_Faster
  # PConv åªå· 1/4 é€šé“ï¼Œè®¡ç®—é‡æä½
  - [-1, 2, C3_Faster, [256, False, 0.25]] # 2
  
  - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
  
  # ğŸš€ [æ›¿æ¢] C3k2 -> C3_Faster
  - [-1, 2, C3_Faster, [512, False, 0.25]] # 4
  
  - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
  
  # ğŸš€ [æ›¿æ¢] C3k2 -> C3_Faster
  - [-1, 2, C3_Faster, [512, True]] # 6
  
  - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32
  
  # ğŸš€ [æ›¿æ¢] C3k2 -> C3_Faster
  - [-1, 2, C3_Faster, [1024, True]] # 8
  
  - [-1, 1, SPPF, [1024, 5]] # 9
  - [-1, 2, C2PSA, [1024]] # 10

# Head (ä¿æŒ Row 11 çš„ FD-Gate ç»“æ„)
head:
  # === æ ‡å‡†çš„ä¸Šé‡‡æ ·è·¯å¾„ ===
  - [-1, 1, DySample, [2, 'lp']] # 11 (P5 -> P4)
  - [[-1, 6], 1, Concat, [1]] 
  - [-1, 2, C3k2, [512, False]] # 13 (Head éƒ¨åˆ†ä¿æŒä¸åŠ¨ï¼Œæ±‚ç¨³)

  - [-1, 1, DySample, [2, 'lp']] # 14 (P4 -> P3)
  - [[-1, 4], 1, Concat, [1]] 
  - [-1, 2, C3k2, [256, False]] # 16 (P3 è¯­ä¹‰æµ)

  # === ç»†èŠ‚åˆ†æ”¯ (Detail Stream) ===
  - [1, 1, ScConv, [128]] # 17 (å»å™ª)
  - [-1, 1, HWD_Down, [128]] # 18 (ä¿ç•™çº¹ç†)

  # === é¢‘ç‡é—¨æ§èåˆ (Frequency Gate) ===
  # 19: èåˆ [è¯­ä¹‰æµ(16), ç»†èŠ‚æµ(18)]
  - [[16, 18], 1, FrequencyGate, [128, 256]] # 19

  # === è¾“å‡ºè·¯å¾„ ===
  - [19, 1, Conv, [256, 3, 2]] 
  - [[-1, 13], 1, Concat, [1]] 
  - [-1, 2, C3k2, [512, False]] # 22

  - [-1, 1, Conv, [512, 3, 2]] 
  - [[-1, 10], 1, Concat, [1]] 
  - [-1, 2, C3k2, [1024, True]] # 25

  - [[19, 22, 25], 1, Detect, [nc]]
