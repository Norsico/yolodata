# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license

# FaRFA-YOLO (Frequency-aware Receptive Field Attention YOLO)
# --------------------------------------------------------
# ç­–ç•¥: "å¼ºä¸»å¹² + å¼ºAttentionç»†èŠ‚æµ"
# 1. Backbone: C3k2 (åŸç”Ÿæœ€ç¨³)ã€‚
# 2. Detail Branch: RFAConv (åŠ¨æ€æ„Ÿå—é‡æ¸…æ´—) + HWD (ç¡¬æ ¸è¾¹ç¼˜æå–)ã€‚
# 3. Head: Gate (æœ€ç®€å•çš„é—¨æ§å¾€å¾€æœ€æœ‰æ•ˆ)ã€‚
# --------------------------------------------------------

# Parameters
nc: 6 
scales: 
  n: [0.50, 0.25, 1024] 

# Backbone
backbone:
  - [-1, 1, Conv, [64, 3, 2]] # 0
  - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4 (ç»†èŠ‚æµæºå¤´)
  - [-1, 2, C3k2, [256, False, 0.25]]
  - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
  - [-1, 2, C3k2, [512, False, 0.25]]
  - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
  - [-1, 2, C3k2, [512, True]]
  - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32
  - [-1, 2, C3k2, [1024, True]]
  - [-1, 1, SPPF, [1024, 5]] # 9
  - [-1, 2, C2PSA, [1024]] # 10

# Head
head:
  # === DySample ä¸Šé‡‡æ · (åŸºæ“) ===
  - [-1, 1, DySample, [2, 'lp']] # 11
  - [[-1, 6], 1, Concat, [1]] 
  - [-1, 2, C3k2, [512, False]] # 13

  - [-1, 1, DySample, [2, 'lp']] # 14
  - [[-1, 4], 1, Concat, [1]] 
  - [-1, 2, C3k2, [256, False]] # 16 (P3 è¯­ä¹‰æµ)

  # === ğŸš€ [å‡çº§ç‚¹] ç»†èŠ‚åˆ†æ”¯ ===
  
  # 17: RFAConv (Receptive Field Attention)
  # æ›¿ä»£ ScConvã€‚åˆ©ç”¨ Group Conv é«˜æ•ˆæå–ç©ºé—´æ³¨æ„åŠ›ã€‚
  - [1, 1, RFAConv, [128]] 
  
  # 18: HWD_Down (Haar Wavelet)
  # é…åˆ RFAConvï¼Œå…ˆèšç„¦(RFA)å†æå–è¾¹ç¼˜(HWD)ï¼Œé€»è¾‘å®Œç¾ã€‚
  - [-1, 1, SPDConv, [128]]

  # === é¢‘ç‡é—¨æ§èåˆ ===
  # 19: å›å½’æœ€ç®€å•çš„ FrequencyGate (Row 11 åŒæ¬¾)
  # RFAConv å·²ç»è‡ªå¸¦æ„Ÿå—é‡æ³¨æ„åŠ›äº†ï¼Œè¿™é‡Œ Gate åªéœ€è¦åšç®€å•çš„é€šé“ç­›é€‰å³å¯ã€‚
  - [[16, 18], 1, FrequencyGate, [128, 256]] 

  # === è¾“å‡ºè·¯å¾„ ===
  - [19, 1, Conv, [256, 3, 2]] 
  - [[-1, 13], 1, Concat, [1]] 
  - [-1, 2, C3k2, [512, False]] # 22

  - [-1, 1, Conv, [512, 3, 2]] 
  - [[-1, 10], 1, Concat, [1]] 
  - [-1, 2, C3k2, [1024, True]] # 25

  - [[19, 22, 25], 1, Detect, [nc]]