# ç­–ç•¥: 
# 1. P3 å±‚ (å°ç›®æ ‡) ä½¿ç”¨ C3k2 é‡è£…ç”²ï¼Œæ­»ç£•çº¹ç†ã€‚
# 2. P4/P5 å±‚ (å¤§ç›®æ ‡) ä½¿ç”¨ C3_PKI å¤§æ ¸ï¼Œè·å–ä¸Šä¸‹æ–‡ã€‚
# 3. Detail Branch é€šé“æ‰©å®¹ã€‚

# Parameters
nc: 10
scales: 
  n: [0.50, 0.25, 1024] 

# Backbone (å…¨å‘˜ C3k2ï¼Œåº•å­è¦åš)
backbone:
  - [-1, 1, Conv, [64, 3, 2]] # 0
  - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4 (Detail Start)
  - [-1, 2, C3k2, [256, False, 0.25]] # 2-P3/8
  - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
  - [-1, 2, C3k2, [512, False, 0.25]] # 4-P4/16
  - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
  - [-1, 2, C3k2, [512, True]] # 6-P5/32
  - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32
  - [-1, 2, C3k2, [1024, True]] # 8-P5/32
  - [-1, 1, SPPF, [1024, 5]] # 9
  - [-1, 2, C2PSA, [1024]] # 10

# Head
head:
  # === UpSample P5 -> P4 ===
  - [-1, 1, DySample, [2, 'lp']] # 11
  - [[-1, 6], 1, Concat, [1]] 
  # âœ… P4 å±‚: ä¿æŒ C3_PKIï¼Œåˆ©ç”¨ 7x7 å¤§æ ¸çœ‹è·¯å†µ (Context)
  - [-1, 2, C3_PKI, [512, False]] # 13 

  # === UpSample P4 -> P3 ===
  - [-1, 1, DySample, [2, 'lp']] # 14
  - [[-1, 4], 1, Concat, [1]] 
  # ğŸ”¥ P3 å±‚: æ¢å› C3k2 !!! 
  # è¿™é‡Œçš„ç‰¹å¾å›¾æ˜¯ 80x80ï¼Œç”¨ C3k2 è®¡ç®—é‡å·¨å¤§ï¼Œèƒ½æŠŠ GFLOPs æ’‘èµ·æ¥ï¼Œç»™ä¸‰è½®è½¦æœ€å¼ºçš„ç‰¹å¾æå–
  - [-1, 2, C3k2, [256, False]] # 16 (P3 Main - é‡è£…ç”²)

  # === Detail Branch (RFA + Gate) ===
  # æŠ€å·§: è¿™é‡Œå†™ [256] æ˜¯ä¸ºäº†å¯¹æŠ— width=0.25 çš„ç¼©æ”¾
  # å¦‚æœ parser æ²¡æœ‰ç‰¹æ®Šå¤„ç†ï¼Œ256*0.25=64ï¼Œåˆšåˆšå¥½
  - [1, 1, RFAConv, [256]] # 17 (P2 -> RFA)
  - [-1, 1, Conv, [256, 3, 2]] # 18 (160 -> 80)
  
  # Gate
  - [[16, 18], 1, FrequencyGate, []] # 19 

  # === Output Path ===
  # P3 -> P4
  - [19, 1, Conv, [256, 3, 2]] # 20
  - [[-1, 13], 1, Concat, [1]] 
  # âœ… P4 è¾“å‡º: C3_PKI (è½»é‡+å¤§æ ¸)
  - [-1, 2, C3_PKI, [512, False]] # 22 

  # P4 -> P5
  - [-1, 1, Conv, [512, 3, 2]] # 23
  - [[-1, 10], 1, Concat, [1]] 
  # âœ… P5 è¾“å‡º: C3_PKI (è½»é‡+å¤§æ ¸)
  - [-1, 2, C3_PKI, [1024, True]] # 25

  # Detect
  - [[19, 22, 25], 1, Detect, [nc]]
