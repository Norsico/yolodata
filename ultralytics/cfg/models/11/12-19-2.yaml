# =============================================================================
# YOLOv11n-Hybrid-SOTA
# Core Logic: 
# 1. P3 (Small Object) -> Keep Heavy C3k2 (From 12-13-2) to save Tricycle.
# 2. P4/P5 (Medium/Large) -> Use VoVGSCSP (From 12-17) to cut GFLOPs.
# 3. Detail Branch -> Optimized 64ch RFAConv.
# Target: GFLOPs ~9.0, Tricycle mAP > 0.22
# =============================================================================

# Parameters
nc: 6 
scales: 
  n: [0.50, 0.25, 1024] 

# Backbone (ä¿æŒå®˜æ–¹åŽŸç‰ˆï¼Œç¨³å¥ç¬¬ä¸€)
backbone:
  - [-1, 1, Conv, [64, 3, 2]] # 0
  - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4
  - [-1, 2, C3k2, [256, False, 0.25]] # 2
  - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
  - [-1, 2, C3k2, [512, False, 0.25]] # 4
  - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
  - [-1, 2, C3k2, [512, True]] # 6
  - [-1, 1, Conv, [1024, 3, 2]] # 7-P5/32
  - [-1, 2, C3k2, [1024, True]] # 8
  - [-1, 1, SPPF, [1024, 5]] # 9
  - [-1, 2, C2PSA, [1024]] # 10

# Head
head:
  # === P5 -> P4 ä¸Šé‡‡æ · ===
  - [-1, 1, DySample, [2, 'lp']] # 11
  - [[-1, 6], 1, Concat, [1]] 
  # ðŸ“‰ [P4 é™ç»´] è¿™é‡Œæ˜¯ä¸­ç›®æ ‡ï¼Œç”¨ VoVGSCSP è¶³å¤Ÿï¼Œçœç®—åŠ›
  # å¦‚æžœä½ çš„ä»£ç é‡Œå« VoVGSCSP_S å°±æ”¹ä¸€ä¸‹åå­—ï¼Œé€šç”¨æ˜¯ VoVGSCSP
  - [-1, 1, VoVGSCSP, [512]] # 13 

  # === P4 -> P3 ä¸Šé‡‡æ · ===
  - [-1, 1, DySample, [2, 'lp']] # 14
  - [[-1, 4], 1, Concat, [1]] 
  
  # ðŸ›¡ï¸ [P3 æ ¸å¿ƒé˜²å¾¡] è¿™é‡Œå¿…é¡»ç”¨ C3k2ï¼
  # 12-17 è¾“å°±è¾“åœ¨è¿™é‡Œç”¨äº† VoVGSCSPã€‚ä¸ºäº†ä¸‰è½®è½¦ï¼Œè¿™é‡Œä¸èƒ½çœï¼
  - [-1, 2, C3k2, [256, False]] # 16 

  # === Detail Branch (64ch ä¼˜åŒ–ç‰ˆ) ===
  # å…ˆä¸‹é‡‡æ · (160->80)
  - [1, 1, Conv, [64, 3, 2]] # 17 
  # å†è·‘ RFAConv (80x80x64)ï¼Œè®¡ç®—é‡é€‚ä¸­ï¼Œæ•ˆæžœå¥½
  - [-1, 1, RFAConv, [64]] # 18 

  # === Gate ===
  # èžåˆ P3(256) å’Œ Detail(64)
  - [[16, 18], 1, FrequencyGate, [256, 256]] # 19 

  # === P3 -> P4 ä¸‹é‡‡æ · ===
  # ä½¿ç”¨ GSConv ä¸‹é‡‡æ ·ï¼Œå‡å°‘å‚æ•°å†—ä½™
  - [19, 1, GSConv, [256, 3, 2]] # 20 
  - [[-1, 13], 1, Concat, [1]] 
  
  # ðŸ“‰ [P4 è¾“å‡º] ç»§ç»­ç”¨ VoVGSCSP çœç®—åŠ›
  - [-1, 1, VoVGSCSP, [512]] # 22 

  # === P4 -> P5 ä¸‹é‡‡æ · ===
  - [-1, 1, GSConv, [512, 3, 2]] # 23 
  - [[-1, 10], 1, Concat, [1]] 
  
  # ðŸ“‰ [P5 è¾“å‡º] å¤§ç›®æ ‡å±‚ï¼Œç”¨ VoVGSCSP è¶³å¤Ÿ
  - [-1, 1, VoVGSCSP, [1024]] # 25 

  - [[19, 22, 25], 1, Detect, [nc]] # 26
